# TMS-Migration-Tool

Tool to migrate all TMS and external server booked meetings to hybrid calendar services.


**What is the purpose of the TMT Application?**

As TMS (Telepresence Management Suite) is phasing out, all meeting scheduled via TMS, or external servers must be moved to hybrid calendar services.
TMT is the application which is built to carry out this task.

**TMT Application Flow**

We have used C# to develop this tool.
Once the user has configured all the fields as mentioned in the Prerequisites and run the TMT application, based on the flag (IsPilotRun) set in the config, the tool will either be used for a pilot run or a complete run. 

For a pilot run, users to be taken into consideration would be mentioned in the setting (PilotUsers) in app config. Multiple users will be separated by semi colon.
If the above flag is set to True, then tool will get the conferences for the pilot users from the given start date. Else, if the above flag is set to False, the tool will get all conferences from the given start date for all the users in TMS. 
If the start date is empty or incorrect or older date, it will be set to current Date and Time.

  We get the users of TMS using Remote Setup API and we get the conference details by using the Booking API. After we get the list of conferences, we loop through the list to update the calendar invite body with the SIP protocol. In doing the update, we go through the below steps: 
o 	We first determine the kind of conference it is, i.e., if it is generated by TMS or Outlook or CalendarConnector based on the External Source Id attribute of the conference.
o 	If it is a CalendarConnector conference, we ignore it without any further processing. Basically, cloud meetings will be ignored.
o 	If it is a TMS generated conference, then we loop through a list of mailboxes to find that conference in the exchange server. To get the list of mailboxes, we refer to the MonitoredMailboxCalendarProperties.csv file which contains the mapping of mailboxes to endpoints, that would be added as participants in the conferences.
o 	Once we get a matching conference, we update the body of the Calendar invite with the SIP URL of that conference by firing an update statement. This same step is repeated by     looping through all the mailboxes and finding the conference for the respective mailbox and firing the update.
o 	If it is an Outlook generated conference, then we find one instance of that conference in the Calendar folder of the mailbox and then fire a single update statement that would update the calendar invite body with the SIP URL for all the participants of that conference.

We finally display a popup box showing the count of successfully processed conferences and failed conferences. We log almost all operations and exceptions can be traced from the logs as well as the count of success and failures of conferences while migrating.



o **Pre-requisites:**
 
o  **Key Value Pairs** 

o	**Configuration Steps**

o	**Known issues**

o	**Getting help**

o	**Credits**

o	**Demo**


**Pre-requisites:**

1.	TMT application (TMSMigrationTool.exe)
2.	TMS server username and password.
3.	Name of the server where Microsoft Exchange is installed (either online or on premise or both, whichever is applicable).
4.	On Premise / Online Username (or both Usernames)
5.	On Premise / Online Password (or both Passwords)
6.	MonitoredMailboxCalendarProperties.csv file to be copied in the folder of TMT application from the customers deployment.
7.	Date (dd-mm-yyyy hh:mm:ss) from when you want the tool to move future meetings.

Note: The TMT application needs to be saved and run on the same machine where TMS is installed.

**Key Value Pairs:**

**TMSServerUsername**
- Username of the server where TMS is installed.

**TMSServerPassword**
- Password of the server where TMS is installed.

**IsExchangeHybrid**
- a boolean flag
- set to true, if customer is using both Exchanges, on premise and online.
- set to false, if only one Exchange is used.

If IsExchangeHybrid= “false”, fill one of the below Exchange information that is applicable (OnPremise or Online)
Else fill both.

**ExchangeOnPremise**
- name of the server where Microsoft Exchange is installed (empty, if not applicable)

**OnPremiseUserName**
- Username to access the Outlook mailbox (empty, if not applicable)

**OnPremisePassword**
- Password to access the Outlook mailbox (empty, if not applicable)

**ExchangeOnline**
- Outlook office 365 (empty, if not applicable)

**OnlineUserName**
- Username to access the Outlook mailbox (empty, if not applicable)

**OnlinePassword**
- Password to access the Outlook mailbox (empty, if not applicable)

**IsPilotRun**
- A boolean flag to determine if it is a trial run or a full run. Set to true for trial run, else false (or empty).

**PilotUsers**
- Incase the above flag is set to true, provide usernames separated by semicolon in this parameter.

**StartDate**
- Date value that would determine the conferences to be considered for updating from this input date
- Date should be in the format of "dd-mm-yyyy hh:mm:ss"

**Configuration steps:**

![Image](https://user-images.githubusercontent.com/119580730/206635046-4a47fc51-534c-4ae0-a066-a4a0c7a2b8f4.png)

1.	In TMS Migration tool, redirect yourself to TMSMigrationTool.exe.config file and fill in these Key Value pairs wherever applicable.
            
Note: 
The TMT application needs to be saved and run on the same machine where TMS is installed.
MonitoredMailboxCalendarProperties.csv file should be copied in the folder of TMT application from the customers deployment.

2. Save and run the TMT application.
3. Please refer log file generated to determine which meetings were successfully migrated and those which couldn't.

**Known issues**

•	This tool is not tested against Online-Exchange or O365.

**Getting Help**

• Please reach out to pavupras@cisco.com / shrpv@cisco.com in case of any queries. support is available on best effort basis.

**Credits:**
1.	Vinay Naik
2.	Shruthi PV
3.	Prasad Pavuluri


**Demo Recording:**

Please refer [Demo Videos](https://github.com/ciscocmsdevnet/TMS-Migration-Tool/tree/main/DemoVideos)

 


